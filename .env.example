# ============================================
# Infrastructure Intelligence Platform
# Environment Configuration Template
# ============================================
# Copy this file to .env and update with your values:
# cp .env.example .env

# ============================================
# DATABASE CONFIGURATION
# ============================================
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_USER=gpr_user
POSTGRES_PASSWORD=changeme_secure_password_here
POSTGRES_DB=gpr_db

# Full database URL (constructed automatically, can override)
DATABASE_URL=postgresql+asyncpg://gpr_user:changeme_secure_password_here@postgres:5432/gpr_db

# ============================================
# BACKEND APPLICATION
# ============================================
# Generate secure key: python3 -c "import secrets; print(secrets.token_urlsafe(32))"
SECRET_KEY=changeme_random_secret_key_at_least_32_characters_long

# Debug mode (true for development, false for production)
DEBUG=true

# Allowed hosts (comma-separated)
ALLOWED_HOSTS=localhost,127.0.0.1

# CORS origins (comma-separated)
CORS_ORIGINS=http://localhost:3000,http://localhost:8000

# Server configuration
HOST=0.0.0.0
PORT=8000

# ============================================
# MINIO OBJECT STORAGE (S3-Compatible)
# ============================================
MINIO_ENDPOINT=minio:9000
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=changeme_minio_password_at_least_8_chars
MINIO_SECURE=false  # Set to true for HTTPS

# Bucket names
MINIO_BUCKET_GPR=gpr-data
MINIO_BUCKET_BIM=bim-models
MINIO_BUCKET_LIDAR=lidar-scans
MINIO_BUCKET_DOCS=documents
MINIO_BUCKET_REPORTS=reports

# ============================================
# REDIS CACHE & MESSAGE BROKER
# ============================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0
REDIS_URL=redis://redis:6379/0

# Redis configuration
REDIS_MAX_CONNECTIONS=50
REDIS_SOCKET_TIMEOUT=5
REDIS_SOCKET_CONNECT_TIMEOUT=5

# ============================================
# CELERY TASK QUEUE
# ============================================
CELERY_BROKER_URL=redis://redis:6379/0
CELERY_RESULT_BACKEND=redis://redis:6379/0

# Celery worker configuration
CELERY_WORKER_CONCURRENCY=4
CELERY_WORKER_MAX_TASKS_PER_CHILD=1000
CELERY_TASK_TIME_LIMIT=3600  # 1 hour timeout
CELERY_TASK_SOFT_TIME_LIMIT=3300  # 55 minutes soft limit

# ============================================
# FRONTEND CONFIGURATION
# ============================================
# API endpoint URL (accessible from browser)
VITE_API_URL=http://localhost:8000

# Tile server URL (for MapLibre basemaps)
VITE_TILE_SERVER_URL=http://localhost:8081

# MinIO endpoint (for direct file downloads)
VITE_MINIO_ENDPOINT=http://localhost:9010

# Application name
VITE_APP_NAME=Infrastructure Intelligence Platform

# ============================================
# LLM CONFIGURATION (OPTIONAL - PHASE 2)
# ============================================
# OpenAI API (for GPT-4o and embeddings)
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_MODEL=gpt-4o
OPENAI_EMBEDDING_MODEL=text-embedding-3-small

# Anthropic API (for Claude - alternative LLM)
ANTHROPIC_API_KEY=your-anthropic-api-key-here
ANTHROPIC_MODEL=claude-3-5-sonnet-20241022

# LangChain configuration
LANGCHAIN_TRACING_V2=false  # Set to true to enable LangSmith tracing
LANGCHAIN_API_KEY=your-langsmith-api-key-here

# ============================================
# LOGGING CONFIGURATION
# ============================================
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FORMAT=json  # json or text
LOG_FILE_PATH=/app/logs/app.log
LOG_FILE_MAX_BYTES=10485760  # 10MB
LOG_FILE_BACKUP_COUNT=5

# ============================================
# APPLICATION SETTINGS
# ============================================
# File upload limits
MAX_UPLOAD_SIZE_MB=1000  # 1GB for LiDAR files
ALLOWED_EXTENSIONS=sgy,dzt,las,laz,ifc,pdf,dwg,dxf,zip,gz

# GPR Processing
GPR_SAMPLING_FREQUENCY=100  # MHz
GPR_TIME_WINDOW=100  # nanoseconds
GPR_DEPTH_CALIBRATION=0.1  # meters per nanosecond

# Batch processing
BATCH_SIZE=10
BATCH_WORKER_COUNT=4

# ML Model Configuration
ML_CONFIDENCE_THRESHOLD=0.75
ML_FEATURE_VECTOR_SIZE=128

# ============================================
# SECURITY SETTINGS
# ============================================
# JWT Token settings
JWT_SECRET_KEY=${SECRET_KEY}
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# Password hashing
BCRYPT_ROUNDS=12

# Rate limiting
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_PER_HOUR=1000

# ============================================
# FEATURE FLAGS (Enable/Disable Features)
# ============================================
ENABLE_GPR_PROCESSING=true
ENABLE_BIM_VALIDATION=false  # Phase 2
ENABLE_LIDAR_PROCESSING=false  # Phase 2
ENABLE_LLM_REPORTS=false  # Phase 2
ENABLE_VECTOR_SEARCH=false  # Phase 2 (PGVector)

# ============================================
# MONITORING & METRICS (OPTIONAL)
# ============================================
ENABLE_METRICS=false
METRICS_PORT=9090
PROMETHEUS_MULTIPROC_DIR=/tmp/prometheus

# Sentry error tracking (optional)
SENTRY_DSN=
SENTRY_ENVIRONMENT=development

# ============================================
# EXTERNAL SERVICES (OPTIONAL)
# ============================================
# MapTiler API (for online tile service - Phase 2)
MAPTILER_API_KEY=your-maptiler-api-key-here

# Pinecone Vector Database (if used instead of PGVector)
PINECONE_API_KEY=your-pinecone-api-key-here
PINECONE_ENVIRONMENT=us-west1-gcp
PINECONE_INDEX_NAME=infrastructure-intelligence

# ============================================
# DEVELOPMENT SETTINGS
# ============================================
# Enable SQL query logging
SQL_ECHO=false

# Enable Uvicorn reload
UVICORN_RELOAD=true

# Python path
PYTHONPATH=/app

# ============================================
# PRODUCTION SETTINGS (Override in production .env)
# ============================================
# DEBUG=false
# SQL_ECHO=false
# UVICORN_RELOAD=false
# LOG_LEVEL=WARNING
# ENABLE_METRICS=true

# ============================================
# NOTES
# ============================================
# 1. NEVER commit .env file to version control
# 2. Generate secure random keys for SECRET_KEY and JWT_SECRET_KEY
# 3. Use strong passwords for POSTGRES_PASSWORD and MINIO_ROOT_PASSWORD
# 4. In production, use AWS Secrets Manager or similar for sensitive values
# 5. Update CORS_ORIGINS to match your production domain
# 6. Set DEBUG=false in production
# 7. Configure proper SSL/TLS certificates for HTTPS
